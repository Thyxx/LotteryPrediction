{% extends 'base.html' %}
{% block title %}Historique {{ label }} · Prédictions Loterie{% endblock %}

{% block content %}
<h1 class="h3 mb-4">Historique complet {{ label }}</h1>
<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Date</th>
            <th>Tirage</th>
            <th>Numéros</th>
            {% if game == 'loto' %}
            <th>Chance</th>
            {% else %}
            <th>Étoiles</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for draw in items %}
          <tr>
            <td>{{ draw.draw_date.strftime('%d/%m/%Y') }}</td>
            <td>{{ draw.draw_number or '-' }}</td>
            <td>
              {% for number in draw.numbers_list() %}
                <span class="badge bg-secondary me-1">{{ '%02d'|format(number) }}</span>
              {% endfor %}
            </td>
            {% if game == 'loto' %}
            <td><span class="badge bg-warning text-dark">{{ '%02d'|format(draw.chance_number) }}</span></td>
            {% else %}
            <td>
              {% for star in draw.star_numbers_list() %}
                <span class="badge bg-warning text-dark me-1">{{ '%02d'|format(star) }}</span>
              {% endfor %}
            </td>
            {% endif %}
          </tr>
          {% else %}
          <tr><td colspan="4" class="text-center text-muted">Aucune donnée disponible.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <nav aria-label="Pagination des tirages" class="d-flex justify-content-between align-items-center">
      <span class="text-muted small">{{ total }} tirages enregistrés</span>
      <ul class="pagination mb-0">
        <li class="page-item{% if current_page <= 1 %} disabled{% endif %}">
          <a class="page-link" href="{{ url_for('main.history', game=game, page=current_page-1) }}">Précédent</a>
        </li>
        {% for page_num in range(1, pages + 1) %}
        <li class="page-item{% if page_num == current_page %} active{% endif %}">
          <a class="page-link" href="{{ url_for('main.history', game=game, page=page_num) }}">{{ page_num }}</a>
        </li>
        {% endfor %}
        <li class="page-item{% if current_page >= pages %} disabled{% endif %}">
          <a class="page-link" href="{{ url_for('main.history', game=game, page=current_page+1) }}">Suivant</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
{% endblock %}

{% block update_info %}
  {% if last_update %}{{ last_update.strftime('%d/%m/%Y %H:%M') }}{% else %}Aucune mise à jour{% endif %}
{% endblock %}
